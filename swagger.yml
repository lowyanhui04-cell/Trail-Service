openapi: 3.0.0
info:
  title: "TrailService API"
  description: "API for managing trails"
  version: "1.0.0"

servers:
  - url: "/api"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      x-bearerInfoFunc: auth.decode_token

  schemas:
    Trail:
      type: "object"
      required:
        - Trail_Name
        - Location
        - Category_ID
        - Difficulty_ID
        - Route_ID
        - User_ID
      properties:
        Trail_ID:
          type: "integer"
          readOnly: true
        Trail_Name:
          type: "string"
        Trail_Description:
          type: "string"
        Location:
          type: "string"
        Distance:
          type: "number"
        Elevation_Gain:
          type: "integer"
        Estimate_Time:
          type: "integer"
        Trail_Info:
          type: "string"
        Category_ID:
          type: "integer"
        Difficulty_ID:
          type: "integer"
        Route_ID:
          type: "integer"
        User_ID:
          type: "integer"

paths:
  /login:
    post:
      operationId: "auth.login"
      tags: ["Authentication"]
      summary: "Login using University Credentials"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email: {type: string}
                password: {type: string}
      responses:
        "200":
          description: "Login successful"
          content:
            application/json:
              schema:
                type: object
                properties:
                  User_ID: {type: integer}
                  Username: {type: string}
                  Role: {type: string}
        "401":
          description: "Unauthorized"

  /trails:
    get:
      operationId: "trails.read_all"
      tags: ["Trails"]
      summary: "Read the list of trails"
      responses:
        "200":
          description: "Successfully read trail list"
    post:
      operationId: "trails.create"
      tags: ["Trails"]
      summary: "Create a new trail"
      security:
        - bearerAuth: []
      requestBody:
        description: "Trail to create"
        required: true
        content:
          application/json:
            schema:
              x-body-name: "trail"
              $ref: "#/components/schemas/Trail"
      responses:
        "201":
          description: "Successfully created trail"

  /trails/{trail_id}:
    get:
      operationId: "trails.read_one"
      tags: ["Trails"]
      summary: "Read one trail"
      parameters:
        - name: "trail_id"
          in: path
          required: true
          schema: {type: "integer"}
      responses:
        "200":
          description: "Successfully read trail"
        "404":
          description: "Trail not found"
    put:
      operationId: "trails.update"
      tags: ["Trails"]
      summary: "Update a trail"
      security:
        - bearerAuth: []
      parameters:
        - name: "trail_id"
          in: path
          required: true
          schema: {type: "integer"}
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Trail"
      responses:
        "200":
          description: "Successfully updated trail"
    delete:
      operationId: "trails.delete"
      tags: ["Trails"]
      summary: "Delete a trail"
      security:
        - bearerAuth: []
      parameters:
        - name: "trail_id"
          in: path
          required: true
          schema: {type: "integer"}
      responses:
        "204":
          description: "Successfully deleted trail"

  /trails/{trail_id}/points:
    get:
      operationId: "trails.get_points"
      tags: ["Trail Points"]
      summary: "Get the path points for a trail"
      parameters:
        - name: "trail_id"
          in: path
          required: true
          schema: {type: "integer"}
      responses:
        "200": {description: "Success"}
        "404": {description: "Trail not found"}
    post:
      operationId: "trails.add_point"
      tags: ["Trail Points"]
      summary: "Add a GPS point to a trail"
      security:
        - bearerAuth: []
      parameters:
        - name: "trail_id"
          in: path
          required: true
          schema: {type: "integer"}
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [Longitude, Latitude]
              properties:
                Point_of_Interest: {type: string}
                Location_Point: {type: string}
                Longitude: {type: number}
                Latitude: {type: number}
      responses:
        "201": {description: "Point added"}

  /trails/{trail_id}/features/{feature_id}:
    post:
      operationId: "features.add_feature_to_trail"
      tags: ["Features"]
      summary: "Link a feature to a trail"
      security:
        - bearerAuth: []
      parameters:
        - name: trail_id
          in: path
          required: true
          schema: {type: integer}
        - name: feature_id
          in: path
          required: true
          schema: {type: integer}
      responses:
        "201":
          description: "Linked successfully"
        "400":
          description: "Error or already exists"

  /points/{point_id}:
    get:
      operationId: "trails.read_one_point"
      tags: ["Trail Points"]
      summary: "Get a specific GPS point"
      parameters:
        - name: point_id
          in: path
          required: true
          schema: {type: integer}
      responses:
        "200": {description: "Success"}
        "404": {description: "Not Found"}
    put:
      operationId: "trails.update_point"
      tags: ["Trail Points"]
      summary: "Update a GPS point"
      security:
        - bearerAuth: []
      parameters:
        - name: point_id
          in: path
          required: true
          schema: {type: integer}
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                Point_of_Interest: {type: string}
                Location_Point: {type: string}
                Longitude: {type: number}
                Latitude: {type: number}
      responses:
        "200": {description: "Updated"}
    delete:
      operationId: "trails.delete_point"
      tags: ["Trail Points"]
      summary: "Delete a GPS point"
      security:
        - bearerAuth: []
      parameters:
        - name: point_id
          in: path
          required: true
          schema: {type: integer}
      responses:
        "204": {description: "Deleted"}

  /features:
    get:
      operationId: "features.read_all"
      tags: ["Features"]
      summary: "Get list of all features"
      responses:
        "200": {description: "Success"}
    post:
      operationId: "features.create_feature"
      tags: ["Features"]
      summary: "Create a new feature definition"
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [Feature_Name]
              properties:
                Feature_Name: {type: string}
                Feature_Description: {type: string}
      responses:
        "201": {description: "Created"}

  /features/{id}:
    get:
      operationId: "features.read_one_feature"
      tags: ["Features"]
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      responses: {"200": {description: "Success"}}
    put:
      operationId: "features.update_feature"
      tags: ["Features"]
      security:
        - bearerAuth: []
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                Feature_Name: {type: string}
                Feature_Description: {type: string}
      responses: {"200": {description: "Updated"}}
    delete:
      operationId: "features.delete_feature"
      tags: ["Features"]
      security:
        - bearerAuth: []
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      responses: {"204": {description: "Deleted"}}

  /categories:
    get:
      operationId: "lookups.get_categories"
      tags: ["Lookups"]
      summary: "List all trail categories"
      responses:
        "200": {description: "Success"}
    post:
      operationId: "lookups.create_category"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema: {type: object, properties: {Category_Name: {type: string}}}
      responses: {"201": {description: "Created"}}

  /categories/{id}:
    get:
      operationId: "lookups.read_one_category"
      tags: ["Lookups"]
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      responses: {"200": {description: "Success"}}
    put:
      operationId: "lookups.update_category"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      requestBody:
        content:
          application/json:
            schema: {type: object, properties: {Category_Name: {type: string}}}
      responses: {"200": {description: "Updated"}}
    delete:
      operationId: "lookups.delete_category"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      responses: {"204": {description: "Deleted"}}

  /difficulties:
    get:
      operationId: "lookups.get_difficulties"
      tags: ["Lookups"]
      summary: "List all difficulty levels"
      responses:
        "200": {description: "Success"}
    post:
      operationId: "lookups.create_difficulty"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema: {type: object, properties: {Difficulty_Name: {type: string}}}
      responses: {"201": {description: "Created"}}

  /difficulties/{id}:
    get:
      operationId: "lookups.read_one_difficulty"
      tags: ["Lookups"]
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      responses: {"200": {description: "Success"}}
    put:
      operationId: "lookups.update_difficulty"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      requestBody:
        content:
          application/json:
            schema: {type: object, properties: {Difficulty_Name: {type: string}}}
      responses: {"200": {description: "Updated"}}
    delete:
      operationId: "lookups.delete_difficulty"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      responses: {"204": {description: "Deleted"}}

  /route-types:
    get:
      operationId: "lookups.get_route_types"
      tags: ["Lookups"]
      summary: "List all route shapes"
      responses:
        "200": {description: "Success"}
    post:
      operationId: "lookups.create_route_type"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema: {type: object, properties: {Route_Type: {type: string}}}
      responses: {"201": {description: "Created"}}

  /route-types/{id}:
    get:
      operationId: "lookups.read_one_route_type"
      tags: ["Lookups"]
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      responses: {"200": {description: "Success"}}
    put:
      operationId: "lookups.update_route_type"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      requestBody:
        content:
          application/json:
            schema: {type: object, properties: {Route_Type: {type: string}}}
      responses: {"200": {description: "Updated"}}
    delete:
      operationId: "lookups.delete_route_type"
      tags: ["Lookups"]
      security:
        - bearerAuth: []
      parameters: [{name: id, in: path, required: true, schema: {type: integer}}]
      responses: {"204": {description: "Deleted"}}